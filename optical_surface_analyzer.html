<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Optical Surface Analyzer</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // Surface type definitions with their parameters
        const surfaceTypes = {
            'Sphere': ['Radius', 'Min Height', 'Max Height'],
            'Even Asphere': ['Radius', 'Conic Constant', 'A4', 'A6', 'A8', 'A10', 'Min Height', 'Max Height'],
            'Odd Asphere': ['Radius', 'Conic Constant', 'A3', 'A5', 'A7', 'A9', 'Min Height', 'Max Height'],
            'Ellipsoid': ['Radius', 'Conic Constant', 'Min Height', 'Max Height'],
            'Parabola': ['Radius', 'Min Height', 'Max Height'],
            'Hyperbola': ['Radius', 'Conic Constant', 'Min Height', 'Max Height'],
            'Toroid': ['Major Radius', 'Minor Radius', 'Min Height', 'Max Height'],
            'Zernike': ['Radius', 'Z1', 'Z2', 'Z3', 'Z4', 'Z5', 'Z6', 'Min Height', 'Max Height']
        };

        // Sample surface data
        const sampleSurfaces = [
            { 
                id: 1, 
                name: 'Primary Mirror', 
                type: 'Even Asphere', 
                color: '#4a90e2',
                parameters: {
                    'Radius': '250.0',
                    'Conic Constant': '-1.0',
                    'A4': '1.2e-7',
                    'A6': '-3.5e-11',
                    'A8': '2.1e-15',
                    'A10': '0',
                    'Min Height': '10.0',
                    'Max Height': '50.0'
                }
            },
            { 
                id: 2, 
                name: 'Secondary Mirror', 
                type: 'Hyperbola', 
                color: '#e94560',
                parameters: {
                    'Radius': '150.0',
                    'Conic Constant': '-2.5',
                    'Min Height': '0',
                    'Max Height': '30.0'
                }
            },
            { 
                id: 3, 
                name: 'Corrector Lens', 
                type: 'Sphere', 
                color: '#2ecc71',
                parameters: {
                    'Radius': '100.0',
                    'Min Height': '0',
                    'Max Height': '25.0'
                }
            },
        ];

        // Icon components
        const PlusIcon = () => (
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <line x1="12" y1="5" x2="12" y2="19" />
                <line x1="5" y1="12" x2="19" y2="12" />
            </svg>
        );

        const MinusIcon = () => (
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <line x1="5" y1="12" x2="19" y2="12" />
            </svg>
        );

        // Main App Component
        const OpticalSurfaceAnalyzer = () => {
            const [surfaces, setSurfaces] = useState(sampleSurfaces);
            const [selectedSurface, setSelectedSurface] = useState(sampleSurfaces[0]);
            const [activeTab, setActiveTab] = useState('summary');
            const [activeSubTab, setActiveSubTab] = useState('3d');
            const plotRef = useRef(null);

            // Update selected surface when it changes in the list
            useEffect(() => {
                const updated = surfaces.find(s => s.id === selectedSurface.id);
                if (updated) {
                    setSelectedSurface(updated);
                }
            }, [surfaces]);

            useEffect(() => {
                if (plotRef.current && activeTab !== 'summary' && activeSubTab === '3d') {
                    create3DPlot();
                } else if (plotRef.current && activeTab !== 'summary' && activeSubTab === '2d') {
                    create2DContour();
                } else if (plotRef.current && activeTab !== 'summary' && activeSubTab === 'cross') {
                    createCrossSection();
                }
            }, [selectedSurface, activeTab, activeSubTab]);

            const create3DPlot = () => {
                const size = 30;
                const x = [], y = [], z = [];
                
                for (let i = 0; i < size; i++) {
                    const xi = -10 + (i * 20) / size;
                    const row = [];
                    for (let j = 0; j < size; j++) {
                        const yj = -10 + (j * 20) / size;
                        const r = Math.sqrt(xi * xi + yj * yj);
                        const sag = (r * r) / (50 * (1 + Math.sqrt(1 - r * r / 2500))) + 0.001 * r * r * r * r;
                        row.push(sag);
                    }
                    z.push(row);
                }

                const data = [{
                    z: z,
                    type: 'surface',
                    colorscale: 'Viridis',
                    showscale: true,
                    contours: {
                        z: {
                            show: true,
                            usecolormap: true,
                            highlightcolor: "#42f462",
                            project: { z: true }
                        }
                    }
                }];

                const layout = {
                    scene: {
                        camera: {
                            eye: { x: 1.5, y: 1.5, z: 1.5 }
                        },
                        xaxis: { title: 'X (mm)' },
                        yaxis: { title: 'Y (mm)' },
                        zaxis: { title: 'Z (mm)' },
                        bgcolor: '#2b2b2b'
                    },
                    paper_bgcolor: '#353535',
                    plot_bgcolor: '#353535',
                    font: { color: '#e0e0e0' },
                    margin: { l: 0, r: 0, t: 0, b: 0 }
                };

                const config = {
                    responsive: true,
                    displayModeBar: true,
                    displaylogo: false
                };

                Plotly.newPlot(plotRef.current, data, layout, config);
            };

            const create2DContour = () => {
                const size = 50;
                const x = [], y = [], z = [];
                
                for (let i = 0; i < size; i++) {
                    const xi = -10 + (i * 20) / size;
                    x.push(xi);
                    const row = [];
                    for (let j = 0; j < size; j++) {
                        const yj = -10 + (j * 20) / size;
                        if (i === 0) y.push(yj);
                        const r = Math.sqrt(xi * xi + yj * yj);
                        const sag = (r * r) / (50 * (1 + Math.sqrt(1 - r * r / 2500))) + 0.001 * r * r * r * r;
                        row.push(sag);
                    }
                    z.push(row);
                }

                const data = [{
                    x: x,
                    y: y,
                    z: z,
                    type: 'contour',
                    colorscale: 'Viridis',
                    showscale: true,
                    contours: {
                        coloring: 'heatmap'
                    }
                }];

                const layout = {
                    xaxis: { title: 'X (mm)' },
                    yaxis: { title: 'Y (mm)' },
                    paper_bgcolor: '#353535',
                    plot_bgcolor: '#2b2b2b',
                    font: { color: '#e0e0e0' },
                    margin: { l: 60, r: 20, t: 20, b: 60 }
                };

                const config = {
                    responsive: true,
                    displayModeBar: true,
                    displaylogo: false
                };

                Plotly.newPlot(plotRef.current, data, layout, config);
            };

            const createCrossSection = () => {
                const points = 100;
                const x = [], y = [];
                
                for (let i = 0; i < points; i++) {
                    const r = (i * 10) / points;
                    x.push(r);
                    const sag = (r * r) / (50 * (1 + Math.sqrt(1 - r * r / 2500))) + 0.001 * r * r * r * r;
                    y.push(sag);
                }

                const data = [{
                    x: x,
                    y: y,
                    type: 'scatter',
                    mode: 'lines',
                    line: { color: '#4a90e2', width: 2 }
                }];

                const layout = {
                    xaxis: { title: 'Radial Distance (mm)' },
                    yaxis: { title: 'Sag (mm)' },
                    paper_bgcolor: '#353535',
                    plot_bgcolor: '#2b2b2b',
                    font: { color: '#e0e0e0' },
                    margin: { l: 60, r: 20, t: 20, b: 60 }
                };

                const config = {
                    responsive: true,
                    displayModeBar: true,
                    displaylogo: false
                };

                Plotly.newPlot(plotRef.current, data, layout, config);
            };

            const updateSurfaceName = (newName) => {
                const updated = surfaces.map(s => 
                    s.id === selectedSurface.id ? { ...s, name: newName } : s
                );
                setSurfaces(updated);
            };

            const updateSurfaceType = (newType) => {
                const newParams = {};
                surfaceTypes[newType].forEach(param => {
                    newParams[param] = selectedSurface.parameters[param] || '0';
                });
                
                const updated = surfaces.map(s => 
                    s.id === selectedSurface.id ? { ...s, type: newType, parameters: newParams } : s
                );
                setSurfaces(updated);
            };

            const updateParameter = (param, value) => {
                const updated = surfaces.map(s => 
                    s.id === selectedSurface.id ? { 
                        ...s, 
                        parameters: { ...s.parameters, [param]: value } 
                    } : s
                );
                setSurfaces(updated);
            };

            const classifySurfaceShape = () => {
                const radius = parseFloat(selectedSurface.parameters['Radius']) || 0;
                const conicConstant = parseFloat(selectedSurface.parameters['Conic Constant']);
                
                let curvature = '';
                let shape = '';

                // Determine curvature
                if (radius > 0) {
                    curvature = 'Concave';
                } else if (radius < 0) {
                    curvature = 'Convex';
                } else {
                    return 'Flat';
                }

                // Determine shape based on type and conic constant
                if (selectedSurface.type === 'Sphere') {
                    shape = 'Sphere';
                } else if (selectedSurface.type === 'Parabola') {
                    shape = 'Parabola';
                } else if (selectedSurface.type === 'Toroid') {
                    shape = 'Toroid';
                } else if (!isNaN(conicConstant)) {
                    if (conicConstant === 0) {
                        shape = 'Sphere';
                    } else if (conicConstant === -1) {
                        shape = 'Parabola';
                    } else if (conicConstant > -1 && conicConstant < 0) {
                        shape = 'Ellipsoid';
                    } else if (conicConstant < -1) {
                        shape = 'Hyperbola';
                    } else if (conicConstant > 0) {
                        shape = 'Oblate Ellipsoid';
                    }
                } else {
                    shape = selectedSurface.type;
                }

                return `${curvature} ${shape}`;
            };

            const colors = {
                bg: '#2b2b2b',
                panel: '#353535',
                border: '#454545',
                text: '#e0e0e0',
                textDim: '#a0a0a0',
                accent: '#4a90e2',
                hover: '#454545'
            };

            const c = colors;

            return (
                <div style={{
                    width: '100vw',
                    height: '100vh',
                    backgroundColor: c.bg,
                    color: c.text,
                    fontFamily: 'Segoe UI, Roboto, sans-serif',
                    display: 'flex',
                    flexDirection: 'column',
                    overflow: 'hidden'
                }}>
                    {/* Menu Bar */}
                    <div style={{
                        height: '40px',
                        backgroundColor: c.panel,
                        borderBottom: `1px solid ${c.border}`,
                        display: 'flex',
                        alignItems: 'center',
                        padding: '0 10px',
                        gap: '20px',
                        fontSize: '14px'
                    }}>
                        <span style={{ fontWeight: 'bold', marginRight: '20px' }}>Optical Surface Analyzer</span>
                        {['File', 'Edit', 'Surface', 'Calculate', 'View', 'Tools', 'Help'].map(menu => (
                            <span key={menu} style={{
                                cursor: 'pointer',
                                padding: '5px 10px',
                                borderRadius: '3px',
                                transition: 'background-color 0.2s'
                            }}
                            onMouseEnter={(e) => e.target.style.backgroundColor = c.hover}
                            onMouseLeave={(e) => e.target.style.backgroundColor = 'transparent'}
                            >
                                {menu}
                            </span>
                        ))}
                    </div>

                    {/* Main Content Area */}
                    <div style={{ display: 'flex', flex: 1, overflow: 'hidden' }}>
                        {/* Left Panel - Surfaces */}
                        <div style={{
                            width: '220px',
                            backgroundColor: c.panel,
                            borderRight: `1px solid ${c.border}`,
                            display: 'flex',
                            flexDirection: 'column'
                        }}>
                            <div style={{
                                padding: '12px',
                                borderBottom: `1px solid ${c.border}`,
                                fontSize: '13px',
                                fontWeight: 'bold'
                            }}>
                                Surfaces
                            </div>
                            <div style={{ flex: 1, overflow: 'auto', padding: '8px' }}>
                                {surfaces.map(surface => (
                                    <div
                                        key={surface.id}
                                        onClick={() => setSelectedSurface(surface)}
                                        style={{
                                            padding: '10px',
                                            marginBottom: '4px',
                                            backgroundColor: selectedSurface.id === surface.id ? c.hover : 'transparent',
                                            borderRadius: '4px',
                                            cursor: 'pointer',
                                            display: 'flex',
                                            alignItems: 'center',
                                            gap: '8px',
                                            transition: 'background-color 0.2s'
                                        }}
                                        onMouseEnter={(e) => {
                                            if (selectedSurface.id !== surface.id) {
                                                e.currentTarget.style.backgroundColor = c.border;
                                            }
                                        }}
                                        onMouseLeave={(e) => {
                                            if (selectedSurface.id !== surface.id) {
                                                e.currentTarget.style.backgroundColor = 'transparent';
                                            }
                                        }}
                                    >
                                        <div style={{
                                            width: '12px',
                                            height: '12px',
                                            borderRadius: '2px',
                                            backgroundColor: surface.color,
                                            flexShrink: 0
                                        }} />
                                        <div style={{ flex: 1, minWidth: 0 }}>
                                            <div style={{ fontSize: '13px', fontWeight: '500', marginBottom: '2px' }}>
                                                {surface.name}
                                            </div>
                                            <div style={{ fontSize: '11px', color: c.textDim }}>
                                                {surface.type}
                                            </div>
                                        </div>
                                    </div>
                                ))}
                            </div>
                            <div style={{
                                padding: '8px',
                                borderTop: `1px solid ${c.border}`,
                                display: 'flex',
                                gap: '8px'
                            }}>
                                <button style={{
                                    flex: 1,
                                    padding: '8px',
                                    backgroundColor: c.accent,
                                    color: 'white',
                                    border: 'none',
                                    borderRadius: '4px',
                                    cursor: 'pointer',
                                    fontSize: '12px',
                                    display: 'flex',
                                    alignItems: 'center',
                                    justifyContent: 'center',
                                    gap: '4px'
                                }}>
                                    <PlusIcon /> Add
                                </button>
                                <button style={{
                                    flex: 1,
                                    padding: '8px',
                                    backgroundColor: c.hover,
                                    color: c.text,
                                    border: `1px solid ${c.border}`,
                                    borderRadius: '4px',
                                    cursor: 'pointer',
                                    fontSize: '12px',
                                    display: 'flex',
                                    alignItems: 'center',
                                    justifyContent: 'center',
                                    gap: '4px'
                                }}>
                                    <MinusIcon /> Remove
                                </button>
                            </div>
                        </div>

                        {/* Center Panel - Visualization */}
                        <div style={{ flex: 1, display: 'flex', flexDirection: 'column', overflow: 'hidden' }}>
                            {/* Main Tabs */}
                            <div style={{
                                display: 'flex',
                                backgroundColor: c.panel,
                                borderBottom: `1px solid ${c.border}`,
                                gap: '2px',
                                padding: '8px 8px 0 8px'
                            }}>
                                {['summary', 'sag', 'slope', 'asphericity', 'aberration'].map(tab => (
                                    <div
                                        key={tab}
                                        onClick={() => {
                                            setActiveTab(tab);
                                            if (tab !== 'summary') setActiveSubTab('3d');
                                        }}
                                        style={{
                                            padding: '8px 16px',
                                            cursor: 'pointer',
                                            backgroundColor: activeTab === tab ? c.bg : 'transparent',
                                            borderTopLeftRadius: '4px',
                                            borderTopRightRadius: '4px',
                                            borderBottom: activeTab === tab ? 'none' : `1px solid ${c.border}`,
                                            fontSize: '13px',
                                            fontWeight: activeTab === tab ? '600' : '400',
                                            color: activeTab === tab ? c.text : c.textDim,
                                            transition: 'all 0.2s'
                                        }}
                                        onMouseEnter={(e) => {
                                            if (activeTab !== tab) {
                                                e.currentTarget.style.backgroundColor = c.hover;
                                            }
                                        }}
                                        onMouseLeave={(e) => {
                                            if (activeTab !== tab) {
                                                e.currentTarget.style.backgroundColor = 'transparent';
                                            }
                                        }}
                                    >
                                        {tab.charAt(0).toUpperCase() + tab.slice(1)}
                                    </div>
                                ))}
                            </div>

                            {/* Sub-tabs for non-summary tabs */}
                            {activeTab !== 'summary' && (
                                <div style={{
                                    display: 'flex',
                                    backgroundColor: c.bg,
                                    borderBottom: `1px solid ${c.border}`,
                                    gap: '2px',
                                    padding: '4px 8px'
                                }}>
                                    {['3d', '2d', 'cross', 'data'].map(subTab => (
                                        <div
                                            key={subTab}
                                            onClick={() => setActiveSubTab(subTab)}
                                            style={{
                                                padding: '6px 12px',
                                                cursor: 'pointer',
                                                backgroundColor: activeSubTab === subTab ? c.panel : 'transparent',
                                                borderRadius: '3px',
                                                fontSize: '12px',
                                                fontWeight: activeSubTab === subTab ? '500' : '400',
                                                color: activeSubTab === subTab ? c.text : c.textDim,
                                                transition: 'all 0.2s'
                                            }}
                                            onMouseEnter={(e) => {
                                                if (activeSubTab !== subTab) {
                                                    e.currentTarget.style.backgroundColor = c.hover;
                                                }
                                            }}
                                            onMouseLeave={(e) => {
                                                if (activeSubTab !== subTab) {
                                                    e.currentTarget.style.backgroundColor = 'transparent';
                                                }
                                            }}
                                        >
                                            {subTab === '3d' ? '3D View' : 
                                             subTab === '2d' ? '2D Contour' : 
                                             subTab === 'cross' ? 'Cross-Section' : 'Data'}
                                        </div>
                                    ))}
                                </div>
                            )}

                            {/* Content Area */}
                            <div style={{ flex: 1, overflow: 'auto', backgroundColor: c.bg }}>
                                {activeTab === 'summary' ? (
                                    <div style={{ padding: '20px' }}>
                                        <h3 style={{ marginBottom: '20px', fontSize: '16px' }}>Surface Summary</h3>
                                        <table style={{
                                            width: '100%',
                                            borderCollapse: 'collapse',
                                            fontSize: '13px'
                                        }}>
                                            <thead>
                                                <tr style={{ borderBottom: `2px solid ${c.border}` }}>
                                                    <th style={{ padding: '10px', textAlign: 'left', color: c.textDim }}>Property</th>
                                                    <th style={{ padding: '10px', textAlign: 'right' }}>Value</th>
                                                    <th style={{ padding: '10px', textAlign: 'left', paddingLeft: '20px' }}>Unit</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr style={{ borderBottom: `1px solid ${c.border}` }}>
                                                    <td style={{ padding: '10px' }}>Height Range</td>
                                                    <td style={{ padding: '10px', textAlign: 'right' }}>
                                                        {selectedSurface.parameters['Min Height']} - {selectedSurface.parameters['Max Height']}
                                                    </td>
                                                    <td style={{ padding: '10px', paddingLeft: '20px' }}>mm</td>
                                                </tr>
                                                <tr style={{ borderBottom: `1px solid ${c.border}` }}>
                                                    <td style={{ padding: '10px' }}>Max Sag</td>
                                                    <td style={{ padding: '10px', textAlign: 'right' }}>2.145</td>
                                                    <td style={{ padding: '10px', paddingLeft: '20px' }}>mm</td>
                                                </tr>
                                                <tr style={{ borderBottom: `1px solid ${c.border}` }}>
                                                    <td style={{ padding: '10px' }}>Max Slope</td>
                                                    <td style={{ padding: '10px', textAlign: 'right' }}>0.198</td>
                                                    <td style={{ padding: '10px', paddingLeft: '20px' }}>rad</td>
                                                </tr>
                                                <tr style={{ borderBottom: `1px solid ${c.border}` }}>
                                                    <td style={{ padding: '10px' }}>Max Asphericity</td>
                                                    <td style={{ padding: '10px', textAlign: 'right' }}>0.043</td>
                                                    <td style={{ padding: '10px', paddingLeft: '20px' }}>mm</td>
                                                </tr>
                                                <tr style={{ borderBottom: `1px solid ${c.border}` }}>
                                                    <td style={{ padding: '10px' }}>Max Asphericity Gradient</td>
                                                    <td style={{ padding: '10px', textAlign: 'right' }}>0.0012</td>
                                                    <td style={{ padding: '10px', paddingLeft: '20px' }}>mm/mm</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                ) : activeSubTab === 'data' ? (
                                    <div style={{ padding: '20px' }}>
                                        <h3 style={{ marginBottom: '20px', fontSize: '16px' }}>
                                            {activeTab.charAt(0).toUpperCase() + activeTab.slice(1)} Data
                                        </h3>
                                        <table style={{
                                            width: '100%',
                                            borderCollapse: 'collapse',
                                            fontSize: '12px'
                                        }}>
                                            <thead>
                                                <tr style={{ borderBottom: `2px solid ${c.border}` }}>
                                                    <th style={{ padding: '8px', textAlign: 'left', color: c.textDim }}>Height (mm)</th>
                                                    <th style={{ padding: '8px', textAlign: 'right' }}>Value</th>
                                                    <th style={{ padding: '8px', textAlign: 'left', paddingLeft: '20px' }}>Unit</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {[10, 15, 20, 25, 30, 35, 40, 45, 50].map((h, idx) => (
                                                    <tr key={idx} style={{ borderBottom: `1px solid ${c.border}` }}>
                                                        <td style={{ padding: '8px' }}>{h}</td>
                                                        <td style={{ padding: '8px', textAlign: 'right' }}>
                                                            {(Math.random() * 2).toFixed(4)}
                                                        </td>
                                                        <td style={{ padding: '8px', paddingLeft: '20px' }}>mm</td>
                                                    </tr>
                                                ))}
                                            </tbody>
                                        </table>
                                    </div>
                                ) : (
                                    <div ref={plotRef} style={{ width: '100%', height: '100%' }} />
                                )}
                            </div>
                        </div>

                        {/* Right Panel - Properties */}
                        <div style={{
                            width: '320px',
                            backgroundColor: c.panel,
                            borderLeft: `1px solid ${c.border}`,
                            display: 'flex',
                            flexDirection: 'column',
                            overflow: 'auto'
                        }}>
                            <div style={{
                                padding: '12px',
                                borderBottom: `1px solid ${c.border}`,
                                fontSize: '13px',
                                fontWeight: 'bold'
                            }}>
                                Properties
                            </div>
                            
                            <div style={{ padding: '12px' }}>
                                {/* Basic Properties */}
                                <PropertySection title="Basic" c={c}>
                                    <div style={{ marginBottom: '8px' }}>
                                        <label style={{ fontSize: '12px', color: c.textDim, display: 'block', marginBottom: '4px' }}>
                                            Name
                                        </label>
                                        <input
                                            type="text"
                                            value={selectedSurface.name}
                                            onChange={(e) => updateSurfaceName(e.target.value)}
                                            style={{
                                                width: '100%',
                                                padding: '6px 8px',
                                                backgroundColor: c.bg,
                                                color: c.text,
                                                border: `1px solid ${c.border}`,
                                                borderRadius: '3px',
                                                fontSize: '13px'
                                            }}
                                        />
                                    </div>
                                    
                                    <div style={{ marginBottom: '8px' }}>
                                        <label style={{ fontSize: '12px', color: c.textDim, display: 'block', marginBottom: '4px' }}>
                                            Type
                                        </label>
                                        <select
                                            value={selectedSurface.type}
                                            onChange={(e) => updateSurfaceType(e.target.value)}
                                            style={{
                                                width: '100%',
                                                padding: '6px 8px',
                                                backgroundColor: c.bg,
                                                color: c.text,
                                                border: `1px solid ${c.border}`,
                                                borderRadius: '3px',
                                                fontSize: '13px',
                                                cursor: 'pointer'
                                            }}
                                        >
                                            {Object.keys(surfaceTypes).map(type => (
                                                <option key={type} value={type}>{type}</option>
                                            ))}
                                        </select>
                                    </div>

                                    <PropertyRow 
                                        label="Shape Classification" 
                                        value={classifySurfaceShape()} 
                                        editable={false} 
                                        c={c} 
                                    />
                                </PropertySection>

                                {/* Parameters */}
                                <PropertySection title="Parameters" c={c}>
                                    {/* Universal Parameters Group */}
                                    <div style={{
                                        padding: '10px',
                                        backgroundColor: c.bg,
                                        borderRadius: '4px',
                                        marginBottom: '12px',
                                        border: `1px solid ${c.border}`
                                    }}>
                                        <div style={{
                                            fontSize: '11px',
                                            fontWeight: '600',
                                            color: c.textDim,
                                            marginBottom: '8px',
                                            textTransform: 'uppercase',
                                            letterSpacing: '0.3px'
                                        }}>
                                            Universal
                                        </div>
                                        {['Radius', 'Min Height', 'Max Height'].map(param => (
                                            selectedSurface.parameters[param] !== undefined && (
                                                <div key={param} style={{ marginBottom: '8px' }}>
                                                    <label style={{ fontSize: '12px', color: c.textDim, display: 'block', marginBottom: '4px' }}>
                                                        {param}
                                                    </label>
                                                    <input
                                                        type="text"
                                                        value={selectedSurface.parameters[param] || '0'}
                                                        onChange={(e) => updateParameter(param, e.target.value)}
                                                        style={{
                                                            width: '100%',
                                                            padding: '6px 8px',
                                                            backgroundColor: c.panel,
                                                            color: c.text,
                                                            border: `1px solid ${c.border}`,
                                                            borderRadius: '3px',
                                                            fontSize: '13px',
                                                            textAlign: 'right'
                                                        }}
                                                    />
                                                </div>
                                            )
                                        ))}
                                    </div>
                                    
                                    {/* Type-Specific Parameters */}
                                    {surfaceTypes[selectedSurface.type].filter(param => 
                                        !['Radius', 'Min Height', 'Max Height'].includes(param)
                                    ).map(param => (
                                        <div key={param} style={{ marginBottom: '8px' }}>
                                            <label style={{ fontSize: '12px', color: c.textDim, display: 'block', marginBottom: '4px' }}>
                                                {param}
                                            </label>
                                            <input
                                                type="text"
                                                value={selectedSurface.parameters[param] || '0'}
                                                onChange={(e) => updateParameter(param, e.target.value)}
                                                style={{
                                                    width: '100%',
                                                    padding: '6px 8px',
                                                    backgroundColor: c.bg,
                                                    color: c.text,
                                                    border: `1px solid ${c.border}`,
                                                    borderRadius: '3px',
                                                    fontSize: '13px',
                                                    textAlign: 'right'
                                                }}
                                            />
                                        </div>
                                    ))}
                                </PropertySection>

                                {/* Calculated Metrics */}
                                <PropertySection title="Calculated Metrics" c={c}>
                                    <PropertyRow label="Paraxial F/#" value="5.2" editable={false} c={c} />
                                    <PropertyRow label="Working F/#" value="5.45" editable={false} c={c} />
                                    <PropertyRow label="Max Sag" value="2.145 mm" editable={false} c={c} />
                                    <PropertyRow label="Max Slope" value="0.198 rad" editable={false} c={c} />
                                    <PropertyRow label="Max Asphericity" value="0.043 mm" editable={false} c={c} />
                                    <PropertyRow label="Max Asph. Gradient" value="0.0012 /mm" editable={false} c={c} />
                                    <PropertyRow label="Best Fit Sphere" value="248.3 mm" editable={false} c={c} />
                                </PropertySection>

                                {/* Quick Actions */}
                                <PropertySection title="Quick Actions" c={c}>
                                    <button style={{
                                        width: '100%',
                                        padding: '8px',
                                        marginBottom: '6px',
                                        backgroundColor: c.hover,
                                        color: c.text,
                                        border: `1px solid ${c.border}`,
                                        borderRadius: '4px',
                                        cursor: 'pointer',
                                        fontSize: '13px'
                                    }}>
                                        Convert
                                    </button>
                                    <button style={{
                                        width: '100%',
                                        padding: '8px',
                                        marginBottom: '6px',
                                        backgroundColor: c.hover,
                                        color: c.text,
                                        border: `1px solid ${c.border}`,
                                        borderRadius: '4px',
                                        cursor: 'pointer',
                                        fontSize: '13px'
                                    }}>
                                        Recalculate
                                    </button>
                                    <button style={{
                                        width: '100%',
                                        padding: '8px',
                                        backgroundColor: c.hover,
                                        color: c.text,
                                        border: `1px solid ${c.border}`,
                                        borderRadius: '4px',
                                        cursor: 'pointer',
                                        fontSize: '13px'
                                    }}>
                                        Export Data
                                    </button>
                                </PropertySection>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // Helper Components
        const PropertySection = ({ title, children, c }) => (
            <div style={{ marginBottom: '14px' }}>
                <div style={{
                    fontSize: '11px',
                    fontWeight: 'bold',
                    textTransform: 'uppercase',
                    color: c.textDim,
                    marginBottom: '8px',
                    letterSpacing: '0.5px'
                }}>
                    {title}
                </div>
                {children}
            </div>
        );

        const PropertyRow = ({ label, value, editable, c }) => (
            <div style={{
                display: 'flex',
                justifyContent: 'space-between',
                alignItems: 'center',
                marginBottom: '6px',
                fontSize: '12px'
            }}>
                <span style={{ color: c.textDim }}>{label}:</span>
                {editable ? (
                    <input
                        type="text"
                        defaultValue={value}
                        style={{
                            width: '110px',
                            padding: '4px 6px',
                            backgroundColor: c.bg,
                            color: c.text,
                            border: `1px solid ${c.border}`,
                            borderRadius: '3px',
                            fontSize: '12px',
                            textAlign: 'right'
                        }}
                    />
                ) : (
                    <span style={{ fontWeight: '500', fontSize: '12px' }}>{value}</span>
                )}
            </div>
        );

        // Render the app
        ReactDOM.render(<OpticalSurfaceAnalyzer />, document.getElementById('root'));
    </script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            overflow: hidden;
        }

        input:focus, select:focus, button:focus {
            outline: 2px solid #4a90e2;
            outline-offset: 2px;
        }

        select {
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg width='10' height='6' viewBox='0 0 10 6' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M1 1L5 5L9 1' stroke='%23a0a0a0' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 8px center;
            padding-right: 28px;
        }

        button:hover {
            opacity: 0.9;
        }

        button:active {
            transform: translateY(1px);
        }
    </style>
</body>
</html>
